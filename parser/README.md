# Parser
 
FeatureExtractionPE.py extracts features from PE(Portable executable) files using [pefile module](https://github.com/erocarrera/pefile).  
 
[Microsoft PE format specification](https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#general-concepts).
 
I was using VX Heavens Virus Collection malware dataset.
 
There are 6 functions that extract features from different parts of executable file and save them in a .csv format.
 
 
- `extract_dlls(open_files_path, save_file_path)` counts how many times certain dll was used in a dataset
 
- `extract_libraries(open_files_path, save_file_path)` defines the libraries and how many times each of them was used in a data set, also determine the dll that contains certain library
 
- `extract_coff_header_features(open_files_path, save_file_path)` extracts features from COFF file header (each row represents each file, colums correspond to the features)
 
- `extract_optional_header_features(open_files_path, save_file_path)` extracts features from Optional header: standard fields and Windows specific fields (each row represents each file, colums correspond to the features)
 
- `extract_optional_header_data_directory(open_files_path, save_file_path)` extracts features from Optional header: data directories (each row represents each file, colums correspond to the features)
 
- `extract_section_header_data_features(open_files_path, save_file_path)` extracts features from Section headers (each row represents each file, colums correspond to the features)
 
- `extract_resources(open_files_path, save_file_path)` extracts resources from .rsrc section and counts them 
 
In that repository you can also find .csv files examples, that were obtained as a result of using above mentioned functions. 
 
**"-1" or "-" in the table's cell means that the feature is absent in a current PE file.** 
 
Thus we got tables ready for static analysis.
 
